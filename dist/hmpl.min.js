!function(e,t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.hmpl=e.hmpl||t()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";const e=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e,t=e=>{throw new Error(e)},o="REQUEST",n="method",s="after",r="mode",l=(o,n,s,r,l,i,d,c={},a,u)=>{const{mode:f,cache:h,redirect:p,get:g,referrerPolicy:m,credentials:y,timeout:v,headers:N,body:E}=c,b={method:r.toUpperCase()};if(void 0!==y&&(b.credentials=y),void 0!==E&&(b.body=E),void 0!==f&&(b.mode=f),void 0!==h&&(b.cache=h),void 0!==p&&(b.redirect=p),void 0!==m&&(b.referrerPolicy=m),N)if(e(N)){const e=new Headers;for(const o in N){const[n,s]=o;if("string"==typeof s)try{e.set(n,s)}catch(e){throw e}else t("Header has no string value")}b.headers=e}else t('The "header" property does not have a value object');v&&(b.signal=AbortSignal.timeout(v));const w=e=>{d?u.status!==e&&(u.status=e,g?.("status",e,u)):a.status!==e&&(a.status=e,g?.("status",e))};w(0),fetch(l,b).then((e=>(w(e.status),e.ok||t(`Request error with code ${e.status}`),e.text()))).then((e=>{const r=(e=>{"string"!=typeof e&&t("Bad response");const o=(new DOMParser).parseFromString(`<template>${e}</template>`,"text/html").childNodes[0].childNodes[0].firstChild,n=o.content,s=n.querySelectorAll("script");for(let e=0;e<s.length;e++){const t=s[e];n.removeChild(t)}return o})(e);if(i)a.response=r,g?.("response",r);else{let e=[];const l=r.content.childNodes;if(s)if(s.nodes){const o=s.parentNode;o||t("parentNode is null");const n=[],r=s.nodes.length;for(let e=0;e<r;e++){const t=s.nodes[e];if(e===r-1)for(let e=0;e<l.length;e++){const s=l[e],r=o.insertBefore(s,t);n.push(r)}o.removeChild(t)}e=n.slice(),s.nodes=n}else{const t=o.parentNode,n=[];for(let e=0;e<l.length;e++){const s=l[e],r=t.insertBefore(s,o);n.push(r)}t.removeChild(o),e=n.slice(),s.nodes=n,s.parentNode=t}else{const t=o.parentNode;for(let n=0;n<l.length;n++){const s=l[n],r=t.insertBefore(s,o);d&&e.push(r)}t.removeChild(o)}d&&(u.response=e,g?.("response",e,u)),g?.("response",n)}})).catch((e=>{throw e}))},i=e=>{var o;e.get&&(o=e.get,"[object Function]"!==Object.prototype.toString.call(o)&&t("The get property has a function value"))};return{compile:d=>{"string"!=typeof d&&t("template was not found or the type of the passed value is not string");const c=(e=>{const o=(new DOMParser).parseFromString(`<template>${e}</template>`,"text/html").childNodes[0].childNodes[0].firstChild;o.content.children.length>1&&t("Template include only one node with type 'Element'");const n=e=>{switch(e.nodeType){case Node.ELEMENT_NODE:if("pre"===e.tagName)return;break;case Node.TEXT_NODE:if(!/\S/.test(e.textContent))return void e.remove()}for(let t=0;t<e.childNodes.length;t++)n(e.childNodes.item(t))};n(o.content.childNodes[0]);return o.content.firstElementChild})(d);c||t("Element is undefined");const a=c.nodeName===o;return((e,i,d=!1)=>{const c=(e,o)=>{const i=e.getAttribute("src");if(i){const c=(e.getAttribute(n)||"GET").toLowerCase();if(!(e=>"get"!==e&&"post"!==e&&"put"!==e&&"delete"!==e&&"patch"!==e)(c)){const n=e.getAttribute(s);n&&d&&t("EventTarget is undefined");let a=e.getAttribute(r),u=(a||"all").toLowerCase();"one"!==u&&"all"!==u&&t(`${r} has only ONE or ALL values`);const f=e.getAttribute("ref"),h="all"===u;let p;h&&n&&(p={nodes:null,parentNode:null});const g=(e,o=!1)=>{if(o){if(f){let o;for(let t=0;t<e.length;t++){const n=e[t];if(n.id===f){o=n.options;break}}return o||t("id referenced by request not found"),o}return{}}return f&&t("id referenced by request not found"),e},m=(t,n,s=!1,r,a=!1)=>{const u=g(t,s);l(e,o,p,c,i,d,a,u,n,r)};let y=m;if(n){const e=(e,t,n,s,r,l,i)=>{const d=o.querySelectorAll(t),c=h?()=>{m(n,s,r,i,l)}:()=>{m(n,s,r,i,l);for(let t=0;t<d.length;t++)d[t].removeEventListener(e,c)};for(let t=0;t<d.length;t++)d[t].addEventListener(e,c)};if(n.indexOf(":")>0){const t=n.split(":"),o=t[0],s=t.slice(1).join(":");y=(t,n,r=!1,l,i=!1)=>{const d=g(t,r);e(o,s,d,n,r,i,l)}}else t(`${s} attribute doesn't work without EventTargets`)}else a&&t(`${r} attribute doesn't work without ${s}`);return y}t(`${n} has only GET, POST, PUT, PATCH or DELETE values`)}else t('The "source" attribute are not found or empty')};let a;if(d)a=c(e);else{const n=e.querySelectorAll(`${o}`),s=[];if(n.length>1){for(let o=0;o<n.length;o++){const r=n[o];null===r.parentNode&&t('"parentNode" is null');const l=c(r,e);s.push(l)}a=(e,t,o=!1)=>{const n=[];for(let r=0;r<s.length;r++){const l={response:void 0,status:0};(0,s[r])(e,t,o,l,!0),n.push(l)}t.requests=n}}else{const o=n[0];null===o.parentNode&&t('"parentNode" is null'),a=c(o,e)}}return i(a)})(c,(o=>(n={})=>{const s={response:a?void 0:c};return a&&(s.status=0),e(n)?(i(n),o(n,s)):Array.isArray(n)&&((o=>{const n=[];for(let s=0;s<o.length;s++){const r=o[s];e(r)||t('options is of type "object"'),i(r);const{id:l}=r;"string"!=typeof r.id&&t('id is of type "string"'),n.indexOf(l)>-1?t(`id with value "${l}" already exists`):n.push(l)}})(n),o(n,s,!0)),s}),a)}}}()}));