!function(e,t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.hmpl=e.hmpl||t()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";const e=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e,t=e=>{throw new Error(e)},o="REQUEST",n="method",r="after",s="mode",i=(o,n,r,s,i,l,d,c={},a,u)=>{const{mode:f,cache:h,redirect:p,get:g,referrerPolicy:m,signal:y,credentials:v,timeout:N,referrer:b,headers:w,body:E,window:T,integrity:A}=c,C={method:s.toUpperCase()};void 0!==v&&(C.credentials=v),void 0!==E&&(C.body=E),void 0!==f&&(C.mode=f),void 0!==h&&(C.cache=h),void 0!==p&&(C.redirect=p),void 0!==m&&(C.referrerPolicy=m),void 0!==A&&(C.integrity=A),void 0!==b&&(C.referrer=b);const j=void 0!==y;if(j&&(C.signal=y),void 0!==T&&(C.window=T),void 0!==c.keepalive&&console.warn("keepalive property is not yet supported"),w)if(e(w)){const e=new Headers;for(const o in w){const[n,r]=o;if("string"==typeof r)try{e.set(n,r)}catch(e){throw e}else t("Header has no string value")}C.headers=e}else t('The "header" property does not have a value object');N&&(j?console.warn("The signal property overwrote the AbortSignal from timeout"):C.signal=AbortSignal.timeout(N));const O=e=>{d?u.status!==e&&(u.status=e,g?.("status",e,u)):a.status!==e&&(a.status=e,g?.("status",e))};O(0),fetch(i,C).then((e=>(O(e.status),e.ok||t(`Request error with code ${e.status}`),e.text()))).then((e=>{const s=(e=>{"string"!=typeof e&&t("Bad response");const o=(new DOMParser).parseFromString(`<template>${e}</template>`,"text/html").childNodes[0].childNodes[0].firstChild,n=o.content,r=n.querySelectorAll("script");for(let e=0;e<r.length;e++){const t=r[e];n.removeChild(t)}return o})(e);if(l)a.response=s,g?.("response",s);else{let e=[];const i=s.content.childNodes;if(r)if(r.nodes){const o=r.parentNode;o||t("parentNode is null");const n=[],s=r.nodes.length;for(let e=0;e<s;e++){const t=r.nodes[e];if(e===s-1)for(let e=0;e<i.length;e++){const r=i[e],s=o.insertBefore(r,t);n.push(s)}o.removeChild(t)}e=n.slice(),r.nodes=n}else{const t=o.parentNode,n=[];for(let e=0;e<i.length;e++){const r=i[e],s=t.insertBefore(r,o);n.push(s)}t.removeChild(o),e=n.slice(),r.nodes=n,r.parentNode=t}else{const t=o.parentNode;for(let n=0;n<i.length;n++){const r=i[n],s=t.insertBefore(r,o);d&&e.push(s)}t.removeChild(o)}d&&(u.response=e,g?.("response",e,u)),g?.("response",n)}})).catch((e=>{throw e}))},l=e=>{var o;e.get&&(o=e.get,"[object Function]"!==Object.prototype.toString.call(o)&&t("The get property has a function value"))};return{compile:d=>{"string"!=typeof d&&t("template was not found or the type of the passed value is not string");const c=(e=>{const o=(new DOMParser).parseFromString(`<template>${e}</template>`,"text/html").childNodes[0].childNodes[0].firstChild;o.content.children.length>1&&t("Template include only one node with type 'Element'");const n=e=>{switch(e.nodeType){case Node.ELEMENT_NODE:if("pre"===e.tagName)return;break;case Node.TEXT_NODE:if(!/\S/.test(e.textContent))return void e.remove()}for(let t=0;t<e.childNodes.length;t++)n(e.childNodes.item(t))};n(o.content.childNodes[0]);const r=o.content.firstElementChild;return r||t("Element is undefined"),r})(d),a=c.nodeName===o;return((e,l,d=!1)=>{const c=(e,o)=>{const l=e.getAttribute("src");if(l){const c=(e.getAttribute(n)||"GET").toLowerCase();if(!(e=>"get"!==e&&"post"!==e&&"put"!==e&&"delete"!==e&&"patch"!==e)(c)){const n=e.getAttribute(r);n&&d&&t("EventTarget is undefined");const a=e.getAttribute(s),u=(a||"all").toLowerCase();"one"!==u&&"all"!==u&&t(`${s} has only ONE or ALL values`);const f=e.getAttribute("ref"),h="all"===u;let p=-1;if(o){const t=o.childNodes;for(let o=0;o<t.length;o++)if(t[o]===e){p=o;break}}const g=(e,o=!1)=>{if(o){if(f){let o;for(let t=0;t<e.length;t++){const n=e[t];if(n.id===f){o=n.options;break}}return o||t("id referenced by request not found"),o}return{}}return f&&t("id referenced by request not found"),e},m=h&&n,y=(e,n,r,s,a,u=!1,f,h=!1,y)=>{const v=s.currentId;if(d)e||(e=o);else if(!e)if(y)e=y.el;else{let o;const{els:n}=s;for(let e=0;e<n.length;e++){const t=n[e];if(t.id===p){y=t,o=t.el;break}}o||t("Element error"),e=o}let N;m&&(y||t("Element error"),N=y.objNode,N||(N={id:v,nodes:null,parentNode:null},y.objNode=N,s.dataObjects.push(N),s.currentId++));const b=g(n,u);i(e,a,N,c,l,d,h,b,r,f)};let v=y;if(n){const e=(e,t,o,n,r,s,i,l,d,c,a)=>{const u=d.querySelectorAll(o),f=h?()=>{y(e,n,r,s,d,i,c,l,a)}:()=>{y(e,n,r,s,d,i,c,l,a);for(let e=0;e<u.length;e++)u[e].removeEventListener(t,f)};for(let e=0;e<u.length;e++)u[e].addEventListener(t,f)};if(n.indexOf(":")>0){const t=n.split(":"),o=t[0],r=t.slice(1).join(":");v=(t,n,s,i,l,d=!1,c,a=!1,u)=>{const f=g(n,d);e(t,o,r,f,s,i,d,a,l,c,u)}}else t(`${r} attribute doesn't work without EventTargets`)}else a&&t(`${s} attribute doesn't work without ${r}`);return v}t(`${n} has only GET, POST, PUT, PATCH or DELETE values`)}else t('The "source" attribute are not found or empty')};let a;if(d)a=c(e);else{const n=e.querySelectorAll(`${o}`),r=[];for(let t=0;t<n.length;t++){const o=n[t];r.push(c(o,e))}if(n.length>1)a=(e,o,n,s,i,l=!1)=>{e||(e=i);const d=[],c=s.els;for(let i=0;i<c.length;i++){const a=c[i],u=a.el;null===u.parentNode&&t('"parentNode" is null');const f={response:void 0,status:0};(0,r[i])(u,o,n,s,e,l,f,!0,a),d.push(f)}n.requests=d};else{const o=n[0];null===o.parentNode&&t('"parentNode" is null'),a=c(o,e)}}return l(a)})(c,(n=>(r={})=>{const s=c.cloneNode(!0),i={response:a?void 0:s};a&&(i.status=0);const d={dataObjects:[],els:[],currentId:0};if(!a){const e=s.childNodes;for(let t=0;t<e.length;t++){const n=e[t];if(n.nodeName===o){const e={el:n,id:t};d.els.push(e)}}}return e(r)?(l(r),n(void 0,r,i,d,s)):Array.isArray(r)&&((o=>{const n=[];for(let r=0;r<o.length;r++){const s=o[r];e(s)||t('options is of type "object"'),l(s);const{id:i}=s;"string"!=typeof s.id&&t('id is of type "string"'),n.indexOf(i)>-1?t(`id with value "${i}" already exists`):n.push(i)}})(r),n(void 0,r,i,d,s,!0)),i}),a)}}}()}));