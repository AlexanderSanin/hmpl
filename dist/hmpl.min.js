(function(a,b){"object"==typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define([],b):a.hmpl=a.hmpl||b()})("undefined"==typeof self?this:self,function(){return function(){"use strict";const a=a=>"object"==typeof a&&!Array.isArray(a)&&null!==a,b=a=>"[object Function]"===Object.prototype.toString.call(a),c=a=>{throw new Error(a)},d=a=>"get"!==a&&"post"!==a&&"put"!==a&&"delete"!==a&&"patch"!==a,e="REQUEST",f=`method`,g=`after`,h=`mode`,i=a=>{"string"!=typeof a&&c("Bad response");const b=new DOMParser().parseFromString(`<template>${a}</template>`,"text/html"),d=b.childNodes[0].childNodes[0].firstChild,e=d.content,f=e.querySelectorAll("script");for(let b=0;b<f.length;b++){const a=f[b];e.removeChild(a)}return d},j=(b,d,e,f,g,h,j,k={},l,m)=>{const{mode:n,cache:o,redirect:p,get:q,referrerPolicy:r,credentials:s,timeout:t,headers:u,requestBody:v}=k,w={method:f.toUpperCase()};if(void 0!==s&&(w.credentials=s),void 0!==v&&(w.body=v),void 0!==n&&(w.mode=n),void 0!==o&&(w.cache=o),void 0!==p&&(w.redirect=p),void 0!==r&&(w.referrerPolicy=r),u)if(a(u)){const a=new Headers;for(const b in u){const[d,e]=b;if("string"==typeof e)try{a.set(d,e)}catch(a){throw a}else c(`Header has no string value`)}w.headers=a}else c(`The "header" property does not have a value object`);t&&(w.signal=AbortSignal.timeout(t));const x=a=>{j?m.status!==a&&(m.status=a,q?.("status",a,m)):l.status!==a&&(l.status=a,q?.("status",a))};x(0),fetch(g,w).then(a=>(x(a.status),a.ok||c(`Request error with code ${a.status}`),a.text())).then(a=>{const f=i(a);if(h)l.response=f,q?.("response",f);else{let a=[];const g=f.content.childNodes;if(!e){const c=b.parentNode;for(let d=0;d<g.length;d++){const e=g[d],f=c.insertBefore(e,b);j&&a.push(f)}c.removeChild(b)}else if(e.nodes){const b=e.parentNode;b||c("parentNode is null");const d=[],f=e.nodes.length;for(let a=0;a<f;a++){const c=e.nodes[a];if(a==f-1)for(let a=0;a<g.length;a++){const e=g[a],f=b.insertBefore(e,c);d.push(f)}b.removeChild(c)}a=d.slice(),e.nodes=d}else{const c=b.parentNode,d=[];for(let a=0;a<g.length;a++){const e=g[a],f=c.insertBefore(e,b);d.push(f)}c.removeChild(b),a=d.slice(),e.nodes=d,e.parentNode=c}j&&(m.response=a,q?.("response",a,m)),q?.("response",d)}}).catch(a=>{throw a})},k=(a,b,i=!1)=>{const k=(a,b)=>{const e=a.getAttribute(`src`);if(e){const k=(a.getAttribute(f)||"GET").toLowerCase();if(d(k))c(`${f} has only GET, POST, PUT, PATCH or DELETE values`);else{const d=a.getAttribute(g);d&&i&&c("EventTarget is undefined");let f=a.getAttribute(h),l=(f||"all").toLowerCase();"one"!==l&&"all"!==l&&c(`${h} has only ONE or ALL values`);const m=a.getAttribute(`ref`),n="all"===l;let o;n&&d&&(o={nodes:null,parentNode:null});const p=(a,b=!1)=>{if(b){if(m){let b;for(let c=0;c<a.length;c++){const d=a[c];if(d.id===m){b=d.options;break}}return b||c("id referenced by request not found"),b}return{}}return m||c("id referenced by request not found"),a},q=(c,d,f=!1,g,h=!1)=>{const l=p(c,f);j(a,b,o,k,e,i,h,l,d,g)};let r=q;if(d){const a=(a,c,d,e,f,g,h)=>{const k=b.querySelectorAll(c),l=n?()=>{q(d,e,f,h,g)}:()=>{q(d,e,f,h,g);for(let b=0;b<k.length;b++){const c=k[b];c.removeEventListener(a,l)}};for(let b=0;b<k.length;b++){const c=k[b];c.addEventListener(a,l)}};if(0<d.indexOf(":")){const b=d.split(":"),c=b[0],e=b.slice(1).join(":");r=(b,d,f=!1,g,h=!1)=>{const i=p(b,f);a(c,e,i,d,f,h,g)}}else c(`${g} attribute doesn't work without EventTargets`)}else f&&c(`${h} attribute doesn't work without ${g}`);return r}}else c(`The "source" attribute are not found or empty`)};let l;if(i)l=k(a);else{const b=a.querySelectorAll(`${e}`),d=[];if(1<b.length){for(let e=0;e<b.length;e++){const f=b[e];null===f.parentNode&&c(`"parentNode" is null`);const g=k(f,a);d.push(g)}l=(a,b,c=!1)=>{const e=[];for(let f=0;f<d.length;f++){const g={response:void 0,status:0},h=d[f];h(a,b,c,g,!0),e.push(g)}b.requests=e}}else{const d=b[0];null===d.parentNode&&c(`"parentNode" is null`),l=k(d,a)}}return b(l)},l=a=>{a.get&&!b(a.get)&&c("The get property has a function value")},m=b=>{const d=[];for(let e=0;e<b.length;e++){const f=b[e];a(f)||c(`options is of type "object"`),l(f);const{id:g}=f;"string"!=typeof f.id&&c(`id is of type "string"`),-1<d.indexOf(g)?c(`id with value "${g}" already exists`):d.push(g)}};return{compile:b=>{"string"!=typeof b&&c("template was not found or the type of the passed value is not string");const d=(a=>{const b=new DOMParser().parseFromString(`<template>${a}</template>`,"text/html"),d=b.childNodes[0].childNodes[0].firstChild;1<d.content.children.length&&c("Template include only one node with type 'Element'");const e=a=>{switch(a.nodeType){case Node.ELEMENT_NODE:if("pre"===a.tagName)return;break;case Node.TEXT_NODE:if(!/\S/.test(a.textContent))return void a.remove();}for(let b=0;b<a.childNodes.length;b++)e(a.childNodes.item(b))};e(d.content.childNodes[0]);const f=d.content.firstElementChild;return f})(b);d||c("Element is undefined");const f=d.nodeName===e;return k(d,b=>{return(c={})=>{const e={response:f?void 0:d};return f&&(e.status=0),a(c)?(l(c),b(c,e)):Array.isArray(c)&&(m(c),b(c,e,!0)),e}},f)}}}()});